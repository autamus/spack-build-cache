---
layout: page
permalink: /manifest/
---

<script>
  (async () => {
    const response = await fetch('https://api.github.com/repos/{{ site.repository }}/contents/');
    const data = await response.json();
    let packages = []
    for (let dir of data) {
      
      // TODO this should be _cache
      if (dir.name == "spack") {
          let url = 'https://api.github.com/repos/{{ site.repository }}/git/trees/' + dir.sha;
          const response = await fetch(url);
          const data = await response.json();
          for (let file of data.tree) {
              packages.push(file)
          }
          break
      }
    }
    result = {"packages": packages, "key": "{{ site.baseurl }}/cache/{{ site.signing_key }}"}
    document.getElementsByTagName('html')[0].innerHTML = JSON.stringify(result)
  })()
</script>
